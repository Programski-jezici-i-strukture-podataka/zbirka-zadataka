
<!DOCTYPE html>

<html lang="sr@latin">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>12. DinamiÄka alokacija memorije &#8212; Zbirka zadataka  dokumentacija</title>
    <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/alabaster.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/tabs.css" />
    <script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js"></script>
    <script src="../../../_static/jquery.js"></script>
    <script src="../../../_static/underscore.js"></script>
    <script src="../../../_static/doctools.js"></script>
    <script src="../../../_static/clipboard.min.js"></script>
    <script src="../../../_static/copybutton.js"></script>
    <script kind="utterances">

    var commentsRunWhenDOMLoaded = cb => {
    if (document.readyState != 'loading') {
        cb()
    } else if (document.addEventListener) {
        document.addEventListener('DOMContentLoaded', cb)
    } else {
        document.attachEvent('onreadystatechange', function() {
        if (document.readyState == 'complete') cb()
        })
    }
}

var addUtterances = () => {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src = "https://utteranc.es/client.js";
    script.async = "async";

    script.setAttribute("repo", "Programski-jezici-i-strukture-podataka/zbirka-zadataka");
    script.setAttribute("issue-term", "pathname");
    script.setAttribute("theme", "github-light");
    script.setAttribute("label", "ğŸ’¬ comment");
    script.setAttribute("crossorigin", "anonymous");

    sections = document.querySelectorAll("div.section");
    if (sections !== null) {
        section = sections[sections.length-1];
        section.appendChild(script);
    }
}
commentsRunWhenDOMLoaded(addUtterances);
</script>
    <script src="../../../_static/translations.js"></script>
    <script src="https://cdn.jsdelivr.net/gh/bonartm/quizdown-js@latest/public/build/quizdown.js"></script>
    <script>quizdown.init({"quizdown_js": "https://cdn.jsdelivr.net/gh/bonartm/quizdown-js@latest/public/build/quizdown.js", "start_on_load": true, "shuffle_answers": true, "shuffle_questions": false, "primary_color": "#FF851B", "secondary_color": "#DDDDDD", "text_color": "black", "locale": "sr"});</script>
    <link rel="index" title="Indeks" href="../../../genindex.html" />
    <link rel="search" title="Pretraga" href="../../../search.html" />
    <link rel="next" title="Zadaci za T12" href="../../../zadaci/t12.html" />
    <link rel="prev" title="11. Bitwise" href="../11_bitwise/index.html" />
   
  <link rel="stylesheet" href="../../../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="dinamicka-alokacija-memorije">
<h1><span class="section-number">12. </span>DinamiÄka alokacija memorije<a class="headerlink" href="#dinamicka-alokacija-memorije" title="Permalink to this headline">Â¶</a></h1>
<p>Podeli svoje utiske o poglavlju na anketi <a class="reference external" href="https://docs.google.com/forms/d/1v87L2JkRzXnvglKgZtM-rPJjTuzB-93z9LHasXQMbA0">https://docs.google.com/forms/d/1v87L2JkRzXnvglKgZtM-rPJjTuzB-93z9LHasXQMbA0</a></p>
<p>Preduslovi za rad:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>Poznavanje funkcija
Poznavanje nizova
Poznavanje pokazivaÄa
</pre></div>
</div>
<p>DinamiÄku alokaciju koristimo kada ne znamo unapred, pre pokretanja programa, koliko nam je memorije potrebno za rad. Do sada smo
u radu sa nizovima uvek unapred odreÄ‘ivali veliÄinu niza. Kada ovako jednom odredimo veliÄinu niza, ne moÅ¾emo je kasnije menjati.
Ta memorija nam moÅ¾e postati mala u nekom trenutku. Problem nedovoljne memorije reÅ¡avamo tako Å¡to je zauzimamo u toku izvrÅ¡avanja
programa, tj. alociramo je dinamiÄki. DinamiÄki alociranu memoriju je potrebno uvek nakon koriÅ¡Ä‡enja osloboditi.</p>
<p>Funkcije za dinamiÄku alokaciju memorije su <code class="docutils literal notranslate"><span class="pre">malloc</span></code>, <code class="docutils literal notranslate"><span class="pre">calloc</span></code>, <code class="docutils literal notranslate"><span class="pre">realloc</span></code> i <code class="docutils literal notranslate"><span class="pre">free</span></code>. Sve funkcije se nalaze u biblioteci <code class="docutils literal notranslate"><span class="pre">stdlib.h</span></code>,
pa je potrebno ukljuÄiti je kako bi ih koristili. Funkcije <code class="docutils literal notranslate"><span class="pre">malloc</span></code> i  <code class="docutils literal notranslate"><span class="pre">calloc</span></code> sluÅ¾e za zauzimanje memorije, a funkcija <code class="docutils literal notranslate"><span class="pre">realloc</span></code>
za proÅ¡irenje/smanjenje prethodno dinamiÄki zauzete memorije. Ove tri funkcije vraÄ‡aju adresu poÄetka memorijskog bloka ukoliko je memorija uspeÅ¡no
zauzeta ili NULL vrednost ukoliko se memorija ne moÅ¾e zauzeti. ImajuÄ‡i ovo u vidu, uvek je potrebno proveriti da li su ove funkcije uspeÅ¡no
zauzele memoriju i izaÄ‡i iz programa ako nisu. Funkcija <code class="docutils literal notranslate"><span class="pre">free</span></code> sluÅ¾i za oslobaÄ‘anje dinamiÄki zauzete memorije.</p>
<section id="malloc">
<h2><span class="section-number">12.1. </span>Malloc<a class="headerlink" href="#malloc" title="Permalink to this headline">Â¶</a></h2>
<p>Funkcija <code class="docutils literal notranslate"><span class="pre">malloc</span></code> se koristi za dinamiÄku alokaciju memorijskog bloka odreÄ‘ene veliÄine. Funkcija vraÄ‡a generiÄki pokazivaÄ
tipa <code class="docutils literal notranslate"><span class="pre">void</span> <span class="pre">*</span></code>, koji se moÅ¾e pretvoriti u bilo koji pokazivaÄ. Ne inicijalizuje zauzetu memoriju na poÄetnu vrednost.
Osnovna forma funkcije je:</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="nf">malloc</span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">size</span><span class="p">);</span>
</pre></div>
</div>
<p>gde <code class="docutils literal notranslate"><span class="pre">size_t</span> <span class="pre">size</span></code> predstavlja veliÄinu memorije koju Ä‡e <code class="docutils literal notranslate"><span class="pre">malloc</span></code> pokuÅ¡ati da zauzme.</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;stdio.h&gt;</span>
<span class="linenos"> 2</span><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;stdlib.h&gt;</span>
<span class="linenos"> 3</span>
<span class="linenos"> 4</span><span class="kt">int</span><span class="w"> </span><span class="nf">main</span><span class="p">()</span>
<span class="linenos"> 5</span><span class="p">{</span>
<span class="linenos"> 6</span><span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="p">;</span>
<span class="linenos"> 7</span>
<span class="linenos"> 8</span><span class="w">    </span><span class="k">do</span>
<span class="linenos"> 9</span><span class="w">    </span><span class="p">{</span>
<span class="linenos">10</span><span class="w">        </span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;Unesite duzinu niza: &quot;</span><span class="p">);</span>
<span class="linenos">11</span><span class="w">        </span><span class="n">scanf</span><span class="p">(</span><span class="s">&quot;%d&quot;</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">n</span><span class="p">);</span>
<span class="linenos">12</span>
<span class="linenos">13</span><span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="k">while</span><span class="p">(</span><span class="n">n</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="mi">0</span><span class="p">);</span>
<span class="linenos">14</span>
<span class="linenos">15</span><span class="w">    </span><span class="n">a</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="n">malloc</span><span class="p">(</span><span class="n">n</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">sizeof</span><span class="p">(</span><span class="kt">int</span><span class="p">));</span>
<span class="linenos">16</span>
<span class="linenos">17</span><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">a</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="nb">NULL</span><span class="p">)</span>
<span class="linenos">18</span><span class="w">    </span><span class="p">{</span>
<span class="linenos">19</span><span class="w">        </span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;Memorija se ne moze zauzeti.</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
<span class="linenos">20</span><span class="w">        </span><span class="n">exit</span><span class="p">(</span><span class="n">EXIT_FAILURE</span><span class="p">);</span>
<span class="linenos">21</span><span class="w">    </span><span class="p">}</span>
<span class="linenos">22</span>
<span class="linenos">23</span><span class="w">    </span><span class="k">for</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">n</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span>
<span class="linenos">24</span><span class="w">    </span><span class="p">{</span>
<span class="linenos">25</span><span class="w">        </span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;a[%d] = &quot;</span><span class="p">,</span><span class="w"> </span><span class="n">i</span><span class="p">);</span>
<span class="linenos">26</span><span class="w">        </span><span class="n">scanf</span><span class="p">(</span><span class="s">&quot;%d&quot;</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">]);</span>
<span class="linenos">27</span><span class="w">    </span><span class="p">}</span>
<span class="linenos">28</span>
<span class="linenos">29</span><span class="w">    </span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;Uneti niz je:</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
<span class="linenos">30</span><span class="w">    </span><span class="k">for</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">n</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span>
<span class="linenos">31</span><span class="w">    </span><span class="p">{</span>
<span class="linenos">32</span><span class="w">        </span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;a[%d] = %d</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">]);</span>
<span class="linenos">33</span><span class="w">    </span><span class="p">}</span>
<span class="linenos">34</span>
<span class="linenos">35</span><span class="w">    </span><span class="n">free</span><span class="p">(</span><span class="n">a</span><span class="p">);</span>
<span class="linenos">36</span><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="linenos">37</span><span class="p">}</span>
</pre></div>
</div>
<p>U primeru iznad prvo unosimo duÅ¾inu niza, a zatim zauzimamo memoriju za taÄno toliko Älanova niza koriÅ¡Ä‡enjem funkcije <code class="docutils literal notranslate"><span class="pre">malloc</span></code>.
Za odreÄ‘ivanje veliÄine memorijskog bloka koji nam je potreban, koristimo operator <code class="docutils literal notranslate"><span class="pre">sizeof</span></code>. Ovaj operator moÅ¾e se koristiti sa
tipovima podataka ili sa promenljivama, tako da je jedan od naÄina da mu prosledimo tip podatka. Na primer, <code class="docutils literal notranslate"><span class="pre">sizeof(int)</span></code> nam daje
veliÄinu jednog integer-a u bajtovima, dok sa izrazom <code class="docutils literal notranslate"><span class="pre">n</span> <span class="pre">*</span> <span class="pre">sizeof(int)</span></code> dobijamo ukupnu veliÄinu memorije potrebnu za ceo niz.</p>
<p>Nakon Å¡to pokuÅ¡amo da zauzmemo memoriju, potrebno je da proverimo da li je to uspeÅ¡no uÄinjeno. Ako <code class="docutils literal notranslate"><span class="pre">malloc</span></code> vrati NULL, to znaÄi
da je zauzimanje memorije neuspeÅ¡no i u tom sluÄaju treba da izaÄ‘emo iz programa. Ako je memorija uspeÅ¡no zauzeta, unosimo Älanove
niza, a zatim ih ispisujemo.</p>
<p>Kada nam viÅ¡e nije potrebna, ili kada smo zavrÅ¡ili sve Å¡to smo planirali u vezi sa dinamiÄkom memorijom, oslobaÄ‘amo zauzetu
memoriju koriÅ¡Ä‡enjem funkcije <code class="docutils literal notranslate"><span class="pre">free</span></code>. Iako u primerima Äesto oslobaÄ‘amo memoriju na kraju programa, u stvarnim aplikacijama,
posebno onima koje rade u realnom vremenu ili u dugoroÄnim procesima (npr. serveri), vaÅ¾no je da oslobaÄ‘amo memoriju Äim nam viÅ¡e
nije potrebna, kako bismo izbegli curenje memorije.</p>
<p>Ispis ovog programa je:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>Unesite duzinu niza: 3
a[0] = 7
a[1] = 2
a[2] = 9
Uneti niz je:
a[0] = 7
a[1] = 2
a[2] = 9
</pre></div>
</div>
</section>
<section id="free">
<h2><span class="section-number">12.2. </span>Free<a class="headerlink" href="#free" title="Permalink to this headline">Â¶</a></h2>
<p>Funkcija <code class="docutils literal notranslate"><span class="pre">free</span></code> sluÅ¾i za oslobaÄ‘anje dinamiÄki zauzete memorije. Memorija se zauzima nekom od funkcija za dinamiÄku alokaciju,
koje vraÄ‡aju pokazivaÄ na zauzetu memoriju. Ova funkcija oÄekuje pokazivaÄ na tu memoriju kako bi je oslobodila.
Osnovna forma funkcije je:</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="kt">void</span><span class="w"> </span><span class="nf">free</span><span class="p">(</span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="n">ptr</span><span class="p">);</span>
</pre></div>
</div>
</section>
<section id="calloc">
<h2><span class="section-number">12.3. </span>Calloc<a class="headerlink" href="#calloc" title="Permalink to this headline">Â¶</a></h2>
<p>Funkcija <code class="docutils literal notranslate"><span class="pre">calloc</span></code> se koristi za dinamiÄku alokaciju memorijskog bloka odreÄ‘ene veliÄine. Blokovi memorije koje alocira funkcija
<code class="docutils literal notranslate"><span class="pre">calloc</span></code> su sukcesivni, Å¡to znaÄi da su rasporeÄ‘eni uzastopno u memoriji. Ovo je bitna karakteristika, jer omoguÄ‡ava
efikasno koriÅ¡Ä‡enje memorije i lakÅ¡e upravljanje sa skupovima podataka koji se koriste u kontinuitetu. Funkcija vraÄ‡a generiÄki
pokazivaÄ tipa <code class="docutils literal notranslate"><span class="pre">void</span> <span class="pre">*</span></code>, koji se moÅ¾e pretvoriti u bilo koji pokazivaÄ. Ukoliko doÄ‘e do greÅ¡ke u alokaciji, funkcija Ä‡e vratiti
<code class="docutils literal notranslate"><span class="pre">NULL</span></code> vrednost. Za razliku od funkcije <code class="docutils literal notranslate"><span class="pre">malloc</span></code>, koja samo alocira memoriju bez inicijalizacije, <code class="docutils literal notranslate"><span class="pre">calloc</span></code> automatski postavlja
sve bajtove u dodeljenoj memoriji na nulu. To znaÄi da Ä‡e svaka pozicija u memoriji biti postavljena na 0 (ili <code class="docutils literal notranslate"><span class="pre">NULL</span></code> u sluÄaju pointera).
Osnovna forma funkcije je:</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="nf">calloc</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">size</span><span class="p">);</span>
</pre></div>
</div>
<p>gde <code class="docutils literal notranslate"><span class="pre">size_t</span> <span class="pre">size</span></code> predstavlja veliÄinu jednog memorijskog bloka, a n broj blokova koje Ä‡e <code class="docutils literal notranslate"><span class="pre">calloc</span></code> pokuÅ¡ati da zauzme.</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;stdio.h&gt;</span>
<span class="linenos"> 2</span><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;stdlib.h&gt;</span>
<span class="linenos"> 3</span>
<span class="linenos"> 4</span><span class="kt">int</span><span class="w"> </span><span class="nf">main</span><span class="p">()</span>
<span class="linenos"> 5</span><span class="p">{</span>
<span class="linenos"> 6</span><span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="p">;</span>
<span class="linenos"> 7</span>
<span class="linenos"> 8</span><span class="w">    </span><span class="k">do</span>
<span class="linenos"> 9</span><span class="w">    </span><span class="p">{</span>
<span class="linenos">10</span><span class="w">        </span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;Unesite duzinu niza: &quot;</span><span class="p">);</span>
<span class="linenos">11</span><span class="w">        </span><span class="n">scanf</span><span class="p">(</span><span class="s">&quot;%d&quot;</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">n</span><span class="p">);</span>
<span class="linenos">12</span>
<span class="linenos">13</span><span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="k">while</span><span class="p">(</span><span class="n">n</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="mi">0</span><span class="p">);</span>
<span class="linenos">14</span>
<span class="linenos">15</span><span class="w">    </span><span class="n">a</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="n">calloc</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="k">sizeof</span><span class="p">(</span><span class="kt">int</span><span class="p">));</span>
<span class="linenos">16</span>
<span class="linenos">17</span><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">a</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="nb">NULL</span><span class="p">)</span>
<span class="linenos">18</span><span class="w">    </span><span class="p">{</span>
<span class="linenos">19</span><span class="w">        </span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;Memorija se ne moze zauzeti.</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
<span class="linenos">20</span><span class="w">        </span><span class="n">exit</span><span class="p">(</span><span class="n">EXIT_FAILURE</span><span class="p">);</span>
<span class="linenos">21</span><span class="w">    </span><span class="p">}</span>
<span class="linenos">22</span>
<span class="linenos">23</span><span class="w">    </span><span class="k">for</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">n</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span>
<span class="linenos">24</span><span class="w">    </span><span class="p">{</span>
<span class="linenos">25</span><span class="w">        </span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;a[%d] = &quot;</span><span class="p">,</span><span class="w"> </span><span class="n">i</span><span class="p">);</span>
<span class="linenos">26</span><span class="w">        </span><span class="n">scanf</span><span class="p">(</span><span class="s">&quot;%d&quot;</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">]);</span>
<span class="linenos">27</span><span class="w">    </span><span class="p">}</span>
<span class="linenos">28</span>
<span class="linenos">29</span><span class="w">    </span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;Uneti niz je:</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
<span class="linenos">30</span><span class="w">    </span><span class="k">for</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">n</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span>
<span class="linenos">31</span><span class="w">    </span><span class="p">{</span>
<span class="linenos">32</span><span class="w">        </span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;a[%d] = %d</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">]);</span>
<span class="linenos">33</span><span class="w">    </span><span class="p">}</span>
<span class="linenos">34</span>
<span class="linenos">35</span><span class="w">    </span><span class="n">free</span><span class="p">(</span><span class="n">a</span><span class="p">);</span>
<span class="linenos">36</span><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="linenos">37</span><span class="p">}</span>
</pre></div>
</div>
<p>U primeru iznad je sve isto kao u primeru sa <code class="docutils literal notranslate"><span class="pre">malloc</span></code> funkcijom, uz razliku da je memorija ovde zauzeta koriÅ¡Ä‡enjem <code class="docutils literal notranslate"><span class="pre">calloc</span></code>
funkcije. Opet je potrebno proveriti da li je memorija uspeÅ¡no zauzeta, kao i osloboditi je na kraju programa.</p>
<p>Ispis ovog programa je:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>Unesite duzinu niza: 3
a[0] = 1
a[1] = 2
a[2] = 3
Uneti niz je:
a[0] = 1
a[1] = 2
a[2] = 3
</pre></div>
</div>
</section>
<section id="realloc">
<h2><span class="section-number">12.4. </span>Realloc<a class="headerlink" href="#realloc" title="Permalink to this headline">Â¶</a></h2>
<p>Funkcija <code class="docutils literal notranslate"><span class="pre">realloc</span></code> koristi se za promenu veliÄine prethodno alociranog bloka memorije. Memorija se prethodno mora zauzeti
koriÅ¡Ä‡enjem funkcija <code class="docutils literal notranslate"><span class="pre">malloc</span></code> ili <code class="docutils literal notranslate"><span class="pre">calloc</span></code>. Realokacijom memorije se zadrÅ¾avaju prethodne vrednosti i ne inicijalizuje se memorija na poÄetnu vrednost.
Ukoliko je potrebno proÅ¡iriti alocirani blok memorije (poveÄ‡ate njegovu veliÄinu), <code class="docutils literal notranslate"><span class="pre">realloc</span></code> Ä‡e to i pokuÅ¡ati. Ako nije moguÄ‡e
proÅ¡iriti memoriju na postojeÄ‡oj lokaciji (zbog fragmentacije ili drugih razloga), <code class="docutils literal notranslate"><span class="pre">realloc</span></code> moÅ¾e alocirati novi blok u nekoj
drugoj lokaciji i prekopirati sadrÅ¾aj iz stare memorije u novu. Ukoliko je potrebno smanjiti veliÄinu memorijskog bloka, <code class="docutils literal notranslate"><span class="pre">realloc</span></code>
jednostavno seÄe blok i oslobaÄ‘a viÅ¡ak memorije, ÄuvajuÄ‡i samo prvih new_size bajtova.
Ako je alokacija uspeÅ¡na, <code class="docutils literal notranslate"><span class="pre">realloc</span></code> vraÄ‡a generiÄki pokazivaÄ na proÅ¡ireni ili skraÄ‡eni memorijski blok tipa <code class="docutils literal notranslate"><span class="pre">void</span> <span class="pre">*</span></code>.
Ovaj pokazivaÄ moÅ¾e biti isti kao prethodni ili moÅ¾e biti nova adresa u sluÄaju premeÅ¡tanja bloka. Ukoliko doÄ‘e do greÅ¡ke i nije
moguÄ‡e alocirati memoriju, <code class="docutils literal notranslate"><span class="pre">realloc</span></code> vraÄ‡a NULL, a originalni blok memorije ostaje nepromenjen.
Osnovna forma funkcije je:</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="nf">realloc</span><span class="p">(</span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="n">ptr</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">new_size</span><span class="p">);</span>
</pre></div>
</div>
<p>gde <code class="docutils literal notranslate"><span class="pre">size_t</span> <span class="pre">new_size</span></code> predstavlja novu veliÄinu memorije koju je potrebno zauzeti, a <code class="docutils literal notranslate"><span class="pre">void</span> <span class="pre">*ptr</span></code> pokazivaÄ na prethodno zauzetu
memoriju koju je potrebno smanjiti ili poveÄ‡ati.</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;stdio.h&gt;</span>
<span class="linenos"> 2</span><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;stdlib.h&gt;</span>
<span class="linenos"> 3</span>
<span class="linenos"> 4</span><span class="kt">int</span><span class="w"> </span><span class="nf">main</span><span class="p">()</span>
<span class="linenos"> 5</span><span class="p">{</span>
<span class="linenos"> 6</span><span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="p">;</span>
<span class="linenos"> 7</span>
<span class="linenos"> 8</span><span class="w">    </span><span class="k">do</span>
<span class="linenos"> 9</span><span class="w">    </span><span class="p">{</span>
<span class="linenos">10</span><span class="w">        </span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;Unesite duzinu niza: &quot;</span><span class="p">);</span>
<span class="linenos">11</span><span class="w">        </span><span class="n">scanf</span><span class="p">(</span><span class="s">&quot;%d&quot;</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">n</span><span class="p">);</span>
<span class="linenos">12</span>
<span class="linenos">13</span><span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="k">while</span><span class="p">(</span><span class="n">n</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="mi">0</span><span class="p">);</span>
<span class="linenos">14</span>
<span class="linenos">15</span><span class="w">    </span><span class="n">a</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="n">malloc</span><span class="p">(</span><span class="n">n</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">sizeof</span><span class="p">(</span><span class="kt">int</span><span class="p">));</span>
<span class="linenos">16</span>
<span class="linenos">17</span><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">a</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="nb">NULL</span><span class="p">)</span>
<span class="linenos">18</span><span class="w">    </span><span class="p">{</span>
<span class="linenos">19</span><span class="w">        </span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;Memorija se ne moze zauzeti.</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
<span class="linenos">20</span><span class="w">        </span><span class="n">exit</span><span class="p">(</span><span class="n">EXIT_FAILURE</span><span class="p">);</span>
<span class="linenos">21</span><span class="w">    </span><span class="p">}</span>
<span class="linenos">22</span>
<span class="linenos">23</span><span class="w">    </span><span class="k">for</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">n</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span>
<span class="linenos">24</span><span class="w">    </span><span class="p">{</span>
<span class="linenos">25</span><span class="w">        </span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;a[%d] = &quot;</span><span class="p">,</span><span class="w"> </span><span class="n">i</span><span class="p">);</span>
<span class="linenos">26</span><span class="w">        </span><span class="n">scanf</span><span class="p">(</span><span class="s">&quot;%d&quot;</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">]);</span>
<span class="linenos">27</span><span class="w">    </span><span class="p">}</span>
<span class="linenos">28</span>
<span class="linenos">29</span><span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">m</span><span class="p">;</span>
<span class="linenos">30</span>
<span class="linenos">31</span><span class="w">    </span><span class="k">do</span>
<span class="linenos">32</span><span class="w">    </span><span class="p">{</span>
<span class="linenos">33</span><span class="w">        </span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;Unesite novu duzinu niza: &quot;</span><span class="p">);</span>
<span class="linenos">34</span><span class="w">        </span><span class="n">scanf</span><span class="p">(</span><span class="s">&quot;%d&quot;</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">m</span><span class="p">);</span>
<span class="linenos">35</span>
<span class="linenos">36</span><span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="k">while</span><span class="p">(</span><span class="n">m</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="mi">0</span><span class="p">);</span>
<span class="linenos">37</span>
<span class="linenos">38</span><span class="w">    </span><span class="c1">// PokuÅ¡aj da se poveÄ‡a veliÄina niza koristeÄ‡i realloc</span>
<span class="linenos">39</span><span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">tmp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="n">realloc</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="n">m</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">sizeof</span><span class="p">(</span><span class="kt">int</span><span class="p">));</span>
<span class="linenos">40</span>
<span class="linenos">41</span><span class="w">    </span><span class="c1">// Provera da li realloc nije uspeo</span>
<span class="linenos">42</span><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">tmp</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="nb">NULL</span><span class="p">)</span>
<span class="linenos">43</span><span class="w">    </span><span class="p">{</span>
<span class="linenos">44</span><span class="w">        </span><span class="c1">// GreÅ¡ka pri alokaciji, originalni blok je i dalje validan</span>
<span class="linenos">45</span><span class="w">        </span><span class="n">free</span><span class="p">(</span><span class="n">a</span><span class="p">);</span><span class="w"> </span><span class="c1">// OslobaÄ‘anje prethodno alocirane memorije</span>
<span class="linenos">46</span><span class="w">        </span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;Memorija se ne moze zauzeti.</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
<span class="linenos">47</span><span class="w">        </span><span class="n">exit</span><span class="p">(</span><span class="n">EXIT_FAILURE</span><span class="p">);</span>
<span class="linenos">48</span><span class="w">    </span><span class="p">}</span>
<span class="linenos">49</span>
<span class="linenos">50</span><span class="w">    </span><span class="c1">// Ako realloc uspe, dodeljujemo novi pokazivaÄ</span>
<span class="linenos">51</span><span class="w">    </span><span class="n">a</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tmp</span><span class="p">;</span>
<span class="linenos">52</span>
<span class="linenos">53</span><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">m</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">n</span><span class="p">)</span>
<span class="linenos">54</span><span class="w">    </span><span class="p">{</span>
<span class="linenos">55</span><span class="w">        </span><span class="k">for</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">n</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">m</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span>
<span class="linenos">56</span><span class="w">        </span><span class="p">{</span>
<span class="linenos">57</span><span class="w">            </span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;a[%d] = &quot;</span><span class="p">,</span><span class="w"> </span><span class="n">i</span><span class="p">);</span>
<span class="linenos">58</span><span class="w">            </span><span class="n">scanf</span><span class="p">(</span><span class="s">&quot;%d&quot;</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">]);</span>
<span class="linenos">59</span><span class="w">        </span><span class="p">}</span>
<span class="linenos">60</span><span class="w">    </span><span class="p">}</span>
<span class="linenos">61</span>
<span class="linenos">62</span><span class="w">    </span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;Uneti niz je:</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
<span class="linenos">63</span><span class="w">    </span><span class="k">for</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">m</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span>
<span class="linenos">64</span><span class="w">    </span><span class="p">{</span>
<span class="linenos">65</span><span class="w">        </span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;a[%d] = %d</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">]);</span>
<span class="linenos">66</span><span class="w">    </span><span class="p">}</span>
<span class="linenos">67</span>
<span class="linenos">68</span><span class="w">    </span><span class="n">free</span><span class="p">(</span><span class="n">a</span><span class="p">);</span>
<span class="linenos">69</span><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="linenos">70</span><span class="p">}</span>
</pre></div>
</div>
<p>U primeru iznad unosimo prvo duÅ¾inu niza, nakon Äega zauzimamo memoriju za taÄno toliko Älanova niza koriÅ¡Ä‡enjem funkcije <code class="docutils literal notranslate"><span class="pre">malloc</span></code>.
Kada smo pokuÅ¡ali da zauzememo memoriju, potrebno je da proverimo da li je ona uspeÅ¡no zauzeta. Ukoliko je <code class="docutils literal notranslate"><span class="pre">malloc</span></code> vratio <code class="docutils literal notranslate"><span class="pre">NULL</span></code>,
izlazimo iz programa, ukoliko nije, unosimo Älanove niza. Nakon toga, unosimo novu duÅ¾inu niza i zauzimamo memoriju za promenjenu
duÅ¾inu koriÅ¡Ä‡enjem funkcije <code class="docutils literal notranslate"><span class="pre">realloc</span></code>. Funkciji <code class="docutils literal notranslate"><span class="pre">realloc</span></code> prosleÄ‘ujemo pokazivaÄ na niz i <code class="docutils literal notranslate"><span class="pre">m</span> <span class="pre">*</span> <span class="pre">sizeof(int)</span></code> gde je <code class="docutils literal notranslate"><span class="pre">m</span></code> nova
duÅ¾ina niza. Potrebno je da ponovo proverimo da li je memorija uspeÅ¡no zauzeta ili je funkcija <code class="docutils literal notranslate"><span class="pre">realloc</span></code> vratila <code class="docutils literal notranslate"><span class="pre">NULL</span></code>. Ukoliko je
memorija zauzeta, proveravamo da li je nova duÅ¾ina niza veÄ‡a od stare i u tom sluÄaju unosimo ostale elemente niza. Za duÅ¾inu niza
sada uzimamo <code class="docutils literal notranslate"><span class="pre">m</span></code>, pa Ä‡e <code class="docutils literal notranslate"><span class="pre">for</span></code> petlja za ispis svih elemenata niza iÄ‡i do ove vrednosti. Na kraju programa, oslobaÄ‘amo dinamiÄki
zauzetu memoriju sa funkcijom <code class="docutils literal notranslate"><span class="pre">free</span></code>.</p>
<p>Ispis ovog programa je:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>Unesite duzinu niza: 3
a[0] = 1
a[1] = 2
a[2] = 3
Unesite novu duzinu niza: 5
a[3] = 4
a[4] = 5
Uneti niz je:
a[0] = 1
a[1] = 2
a[2] = 3
a[3] = 4
a[4] = 5
</pre></div>
</div>
</section>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../../../index.html">Zbirka zadataka</a></h1>








<h3>Navigacija</h3>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../../index.html">Praktikum</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../zadaci/t12.html">Zadaci za T12</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../zadaci/t34.html">Zadaci za T34</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../zadaci/sov.html">Zadaci za SOV</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../../../index.html">Documentation overview</a><ul>
  <li><a href="../../index.html">Praktikum</a><ul>
      <li>Previous: <a href="../11_bitwise/index.html" title="Ğ¿Ñ€ĞµÑ‚Ñ…Ğ¾Ğ´Ğ½Ğ° Ğ³Ğ»Ğ°Ğ²Ğ°"><span class="section-number">11. </span>Bitwise</a></li>
      <li>Next: <a href="../../../zadaci/t12.html" title="Ğ½Ğ°Ñ€ĞµĞ´Ğ½Ğ° Ğ³Ğ»Ğ°Ğ²Ğ°">Zadaci za T12</a></li>
  </ul></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Brza pretraga</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="TraÅ¾i" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2024, SrÄ‘an Popov, Rade RadiÅ¡iÄ‡.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 4.4.0</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="../../../_sources/praktikum/poglavlja/12_dinamicka_alokacija/index.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>