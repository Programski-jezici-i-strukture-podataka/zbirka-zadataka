
<!DOCTYPE html>

<html lang="sr@latin">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>12. Dinamička alokacija memorije &#8212; Zbirka zadataka  dokumentacija</title>
    <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/alabaster.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/tabs.css" />
    <script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js"></script>
    <script src="../../../_static/jquery.js"></script>
    <script src="../../../_static/underscore.js"></script>
    <script src="../../../_static/doctools.js"></script>
    <script src="../../../_static/clipboard.min.js"></script>
    <script src="../../../_static/copybutton.js"></script>
    <script kind="utterances">

    var commentsRunWhenDOMLoaded = cb => {
    if (document.readyState != 'loading') {
        cb()
    } else if (document.addEventListener) {
        document.addEventListener('DOMContentLoaded', cb)
    } else {
        document.attachEvent('onreadystatechange', function() {
        if (document.readyState == 'complete') cb()
        })
    }
}

var addUtterances = () => {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src = "https://utteranc.es/client.js";
    script.async = "async";

    script.setAttribute("repo", "Programski-jezici-i-strukture-podataka/zbirka-zadataka");
    script.setAttribute("issue-term", "pathname");
    script.setAttribute("theme", "github-light");
    script.setAttribute("label", "💬 comment");
    script.setAttribute("crossorigin", "anonymous");

    sections = document.querySelectorAll("div.section");
    if (sections !== null) {
        section = sections[sections.length-1];
        section.appendChild(script);
    }
}
commentsRunWhenDOMLoaded(addUtterances);
</script>
    <script src="../../../_static/translations.js"></script>
    <script src="https://cdn.jsdelivr.net/gh/bonartm/quizdown-js@latest/public/build/quizdown.js"></script>
    <script>quizdown.init({"quizdown_js": "https://cdn.jsdelivr.net/gh/bonartm/quizdown-js@latest/public/build/quizdown.js", "start_on_load": true, "shuffle_answers": true, "shuffle_questions": false, "primary_color": "#FF851B", "secondary_color": "#DDDDDD", "text_color": "black", "locale": "sr"});</script>
    <link rel="index" title="Indeks" href="../../../genindex.html" />
    <link rel="search" title="Pretraga" href="../../../search.html" />
    <link rel="next" title="Zadaci za T12" href="../../../zadaci/t12.html" />
    <link rel="prev" title="11. Bitwise" href="../11_bitwise/index.html" />
   
  <link rel="stylesheet" href="../../../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="dinamicka-alokacija-memorije">
<h1><span class="section-number">12. </span>Dinamička alokacija memorije<a class="headerlink" href="#dinamicka-alokacija-memorije" title="Permalink to this headline">¶</a></h1>
<p>Podeli svoje utiske o poglavlju na anketi <a class="reference external" href="https://docs.google.com/forms/d/1v87L2JkRzXnvglKgZtM-rPJjTuzB-93z9LHasXQMbA0">https://docs.google.com/forms/d/1v87L2JkRzXnvglKgZtM-rPJjTuzB-93z9LHasXQMbA0</a></p>
<p>Preduslovi za rad:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>Poznavanje funkcija
Poznavanje nizova
Poznavanje pokazivača
</pre></div>
</div>
<p>Dinamičku alokaciju koristimo kada ne znamo unapred, pre pokretanja programa, koliko nam je memorije potrebno za rad. Do sada smo
u radu sa nizovima uvek unapred određivali veličinu niza. Kada ovako jednom odredimo veličinu niza, ne možemo je kasnije menjati.
Ta memorija nam može postati mala u nekom trenutku. Problem nedovoljne memorije rešavamo tako što je zauzimamo u toku izvršavanja
programa, tj. alociramo je dinamički. Dinamički alociranu memoriju je potrebno uvek nakon korišćenja osloboditi.</p>
<p>Funkcije za dinamičku alokaciju memorije su <code class="docutils literal notranslate"><span class="pre">malloc</span></code>, <code class="docutils literal notranslate"><span class="pre">calloc</span></code>, <code class="docutils literal notranslate"><span class="pre">realloc</span></code> i <code class="docutils literal notranslate"><span class="pre">free</span></code>. Sve funkcije se nalaze u biblioteci <code class="docutils literal notranslate"><span class="pre">stdlib.h</span></code>,
pa je potrebno uključiti je kako bi ih koristili. Funkcije <code class="docutils literal notranslate"><span class="pre">malloc</span></code> i  <code class="docutils literal notranslate"><span class="pre">calloc</span></code> služe za zauzimanje memorije, a funkcija <code class="docutils literal notranslate"><span class="pre">realloc</span></code>
za proširenje/smanjenje prethodno dinamički zauzete memorije. Ove tri funkcije vraćaju adresu početka memorijskog bloka ukoliko je memorija uspešno
zauzeta ili NULL vrednost ukoliko se memorija ne može zauzeti. Imajući ovo u vidu, uvek je potrebno proveriti da li su ove funkcije uspešno
zauzele memoriju i izaći iz programa ako nisu. Funkcija <code class="docutils literal notranslate"><span class="pre">free</span></code> služi za oslobađanje dinamički zauzete memorije.</p>
<section id="malloc">
<h2><span class="section-number">12.1. </span>Malloc<a class="headerlink" href="#malloc" title="Permalink to this headline">¶</a></h2>
<p>Funkcija <code class="docutils literal notranslate"><span class="pre">malloc</span></code> se koristi za dinamičku alokaciju memorijskog bloka određene veličine. Funkcija vraća generički pokazivač
tipa <code class="docutils literal notranslate"><span class="pre">void</span> <span class="pre">*</span></code>, koji se može pretvoriti u bilo koji pokazivač. Ne inicijalizuje zauzetu memoriju na početnu vrednost.
Osnovna forma funkcije je:</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="nf">malloc</span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">size</span><span class="p">);</span>
</pre></div>
</div>
<p>gde <code class="docutils literal notranslate"><span class="pre">size_t</span> <span class="pre">size</span></code> predstavlja veličinu memorije koju će <code class="docutils literal notranslate"><span class="pre">malloc</span></code> pokušati da zauzme.</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;stdio.h&gt;</span>
<span class="linenos"> 2</span><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;stdlib.h&gt;</span>
<span class="linenos"> 3</span>
<span class="linenos"> 4</span><span class="kt">int</span><span class="w"> </span><span class="nf">main</span><span class="p">()</span>
<span class="linenos"> 5</span><span class="p">{</span>
<span class="linenos"> 6</span><span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="p">;</span>
<span class="linenos"> 7</span>
<span class="linenos"> 8</span><span class="w">    </span><span class="k">do</span>
<span class="linenos"> 9</span><span class="w">    </span><span class="p">{</span>
<span class="linenos">10</span><span class="w">        </span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;Unesite duzinu niza: &quot;</span><span class="p">);</span>
<span class="linenos">11</span><span class="w">        </span><span class="n">scanf</span><span class="p">(</span><span class="s">&quot;%d&quot;</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">n</span><span class="p">);</span>
<span class="linenos">12</span>
<span class="linenos">13</span><span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="k">while</span><span class="p">(</span><span class="n">n</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="mi">0</span><span class="p">);</span>
<span class="linenos">14</span>
<span class="linenos">15</span><span class="w">    </span><span class="n">a</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="n">malloc</span><span class="p">(</span><span class="n">n</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">sizeof</span><span class="p">(</span><span class="kt">int</span><span class="p">));</span>
<span class="linenos">16</span>
<span class="linenos">17</span><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">a</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="nb">NULL</span><span class="p">)</span>
<span class="linenos">18</span><span class="w">    </span><span class="p">{</span>
<span class="linenos">19</span><span class="w">        </span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;Memorija se ne moze zauzeti.</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
<span class="linenos">20</span><span class="w">        </span><span class="n">exit</span><span class="p">(</span><span class="n">EXIT_FAILURE</span><span class="p">);</span>
<span class="linenos">21</span><span class="w">    </span><span class="p">}</span>
<span class="linenos">22</span>
<span class="linenos">23</span><span class="w">    </span><span class="k">for</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">n</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span>
<span class="linenos">24</span><span class="w">    </span><span class="p">{</span>
<span class="linenos">25</span><span class="w">        </span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;a[%d] = &quot;</span><span class="p">,</span><span class="w"> </span><span class="n">i</span><span class="p">);</span>
<span class="linenos">26</span><span class="w">        </span><span class="n">scanf</span><span class="p">(</span><span class="s">&quot;%d&quot;</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">]);</span>
<span class="linenos">27</span><span class="w">    </span><span class="p">}</span>
<span class="linenos">28</span>
<span class="linenos">29</span><span class="w">    </span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;Uneti niz je:</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
<span class="linenos">30</span><span class="w">    </span><span class="k">for</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">n</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span>
<span class="linenos">31</span><span class="w">    </span><span class="p">{</span>
<span class="linenos">32</span><span class="w">        </span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;a[%d] = %d</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">]);</span>
<span class="linenos">33</span><span class="w">    </span><span class="p">}</span>
<span class="linenos">34</span>
<span class="linenos">35</span><span class="w">    </span><span class="n">free</span><span class="p">(</span><span class="n">a</span><span class="p">);</span>
<span class="linenos">36</span><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="linenos">37</span><span class="p">}</span>
</pre></div>
</div>
<p>U primeru iznad prvo unosimo dužinu niza, a zatim zauzimamo memoriju za tačno toliko članova niza korišćenjem funkcije <code class="docutils literal notranslate"><span class="pre">malloc</span></code>.
Za određivanje veličine memorijskog bloka koji nam je potreban, koristimo operator <code class="docutils literal notranslate"><span class="pre">sizeof</span></code>. Ovaj operator može se koristiti sa
tipovima podataka ili sa promenljivama, tako da je jedan od načina da mu prosledimo tip podatka. Na primer, <code class="docutils literal notranslate"><span class="pre">sizeof(int)</span></code> nam daje
veličinu jednog integer-a u bajtovima, dok sa izrazom <code class="docutils literal notranslate"><span class="pre">n</span> <span class="pre">*</span> <span class="pre">sizeof(int)</span></code> dobijamo ukupnu veličinu memorije potrebnu za ceo niz.</p>
<p>Nakon što pokušamo da zauzmemo memoriju, potrebno je da proverimo da li je to uspešno učinjeno. Ako <code class="docutils literal notranslate"><span class="pre">malloc</span></code> vrati NULL, to znači
da je zauzimanje memorije neuspešno i u tom slučaju treba da izađemo iz programa. Ako je memorija uspešno zauzeta, unosimo članove
niza, a zatim ih ispisujemo.</p>
<p>Kada nam više nije potrebna, ili kada smo završili sve što smo planirali u vezi sa dinamičkom memorijom, oslobađamo zauzetu
memoriju korišćenjem funkcije <code class="docutils literal notranslate"><span class="pre">free</span></code>. Iako u primerima često oslobađamo memoriju na kraju programa, u stvarnim aplikacijama,
posebno onima koje rade u realnom vremenu ili u dugoročnim procesima (npr. serveri), važno je da oslobađamo memoriju čim nam više
nije potrebna, kako bismo izbegli curenje memorije.</p>
<p>Ispis ovog programa je:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>Unesite duzinu niza: 3
a[0] = 7
a[1] = 2
a[2] = 9
Uneti niz je:
a[0] = 7
a[1] = 2
a[2] = 9
</pre></div>
</div>
</section>
<section id="free">
<h2><span class="section-number">12.2. </span>Free<a class="headerlink" href="#free" title="Permalink to this headline">¶</a></h2>
<p>Funkcija <code class="docutils literal notranslate"><span class="pre">free</span></code> služi za oslobađanje dinamički zauzete memorije. Memorija se zauzima nekom od funkcija za dinamičku alokaciju,
koje vraćaju pokazivač na zauzetu memoriju. Ova funkcija očekuje pokazivač na tu memoriju kako bi je oslobodila.
Osnovna forma funkcije je:</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="kt">void</span><span class="w"> </span><span class="nf">free</span><span class="p">(</span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="n">ptr</span><span class="p">);</span>
</pre></div>
</div>
</section>
<section id="calloc">
<h2><span class="section-number">12.3. </span>Calloc<a class="headerlink" href="#calloc" title="Permalink to this headline">¶</a></h2>
<p>Funkcija <code class="docutils literal notranslate"><span class="pre">calloc</span></code> se koristi za dinamičku alokaciju memorijskog bloka određene veličine. Blokovi memorije koje alocira funkcija
<code class="docutils literal notranslate"><span class="pre">calloc</span></code> su sukcesivni, što znači da su raspoređeni uzastopno u memoriji. Ovo je bitna karakteristika, jer omogućava
efikasno korišćenje memorije i lakše upravljanje sa skupovima podataka koji se koriste u kontinuitetu. Funkcija vraća generički
pokazivač tipa <code class="docutils literal notranslate"><span class="pre">void</span> <span class="pre">*</span></code>, koji se može pretvoriti u bilo koji pokazivač. Ukoliko dođe do greške u alokaciji, funkcija će vratiti
<code class="docutils literal notranslate"><span class="pre">NULL</span></code> vrednost. Za razliku od funkcije <code class="docutils literal notranslate"><span class="pre">malloc</span></code>, koja samo alocira memoriju bez inicijalizacije, <code class="docutils literal notranslate"><span class="pre">calloc</span></code> automatski postavlja
sve bajtove u dodeljenoj memoriji na nulu. To znači da će svaka pozicija u memoriji biti postavljena na 0 (ili <code class="docutils literal notranslate"><span class="pre">NULL</span></code> u slučaju pointera).
Osnovna forma funkcije je:</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="nf">calloc</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">size</span><span class="p">);</span>
</pre></div>
</div>
<p>gde <code class="docutils literal notranslate"><span class="pre">size_t</span> <span class="pre">size</span></code> predstavlja veličinu jednog memorijskog bloka, a n broj blokova koje će <code class="docutils literal notranslate"><span class="pre">calloc</span></code> pokušati da zauzme.</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;stdio.h&gt;</span>
<span class="linenos"> 2</span><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;stdlib.h&gt;</span>
<span class="linenos"> 3</span>
<span class="linenos"> 4</span><span class="kt">int</span><span class="w"> </span><span class="nf">main</span><span class="p">()</span>
<span class="linenos"> 5</span><span class="p">{</span>
<span class="linenos"> 6</span><span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="p">;</span>
<span class="linenos"> 7</span>
<span class="linenos"> 8</span><span class="w">    </span><span class="k">do</span>
<span class="linenos"> 9</span><span class="w">    </span><span class="p">{</span>
<span class="linenos">10</span><span class="w">        </span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;Unesite duzinu niza: &quot;</span><span class="p">);</span>
<span class="linenos">11</span><span class="w">        </span><span class="n">scanf</span><span class="p">(</span><span class="s">&quot;%d&quot;</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">n</span><span class="p">);</span>
<span class="linenos">12</span>
<span class="linenos">13</span><span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="k">while</span><span class="p">(</span><span class="n">n</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="mi">0</span><span class="p">);</span>
<span class="linenos">14</span>
<span class="linenos">15</span><span class="w">    </span><span class="n">a</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="n">calloc</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="k">sizeof</span><span class="p">(</span><span class="kt">int</span><span class="p">));</span>
<span class="linenos">16</span>
<span class="linenos">17</span><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">a</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="nb">NULL</span><span class="p">)</span>
<span class="linenos">18</span><span class="w">    </span><span class="p">{</span>
<span class="linenos">19</span><span class="w">        </span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;Memorija se ne moze zauzeti.</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
<span class="linenos">20</span><span class="w">        </span><span class="n">exit</span><span class="p">(</span><span class="n">EXIT_FAILURE</span><span class="p">);</span>
<span class="linenos">21</span><span class="w">    </span><span class="p">}</span>
<span class="linenos">22</span>
<span class="linenos">23</span><span class="w">    </span><span class="k">for</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">n</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span>
<span class="linenos">24</span><span class="w">    </span><span class="p">{</span>
<span class="linenos">25</span><span class="w">        </span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;a[%d] = &quot;</span><span class="p">,</span><span class="w"> </span><span class="n">i</span><span class="p">);</span>
<span class="linenos">26</span><span class="w">        </span><span class="n">scanf</span><span class="p">(</span><span class="s">&quot;%d&quot;</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">]);</span>
<span class="linenos">27</span><span class="w">    </span><span class="p">}</span>
<span class="linenos">28</span>
<span class="linenos">29</span><span class="w">    </span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;Uneti niz je:</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
<span class="linenos">30</span><span class="w">    </span><span class="k">for</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">n</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span>
<span class="linenos">31</span><span class="w">    </span><span class="p">{</span>
<span class="linenos">32</span><span class="w">        </span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;a[%d] = %d</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">]);</span>
<span class="linenos">33</span><span class="w">    </span><span class="p">}</span>
<span class="linenos">34</span>
<span class="linenos">35</span><span class="w">    </span><span class="n">free</span><span class="p">(</span><span class="n">a</span><span class="p">);</span>
<span class="linenos">36</span><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="linenos">37</span><span class="p">}</span>
</pre></div>
</div>
<p>U primeru iznad je sve isto kao u primeru sa <code class="docutils literal notranslate"><span class="pre">malloc</span></code> funkcijom, uz razliku da je memorija ovde zauzeta korišćenjem <code class="docutils literal notranslate"><span class="pre">calloc</span></code>
funkcije. Opet je potrebno proveriti da li je memorija uspešno zauzeta, kao i osloboditi je na kraju programa.</p>
<p>Ispis ovog programa je:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>Unesite duzinu niza: 3
a[0] = 1
a[1] = 2
a[2] = 3
Uneti niz je:
a[0] = 1
a[1] = 2
a[2] = 3
</pre></div>
</div>
</section>
<section id="realloc">
<h2><span class="section-number">12.4. </span>Realloc<a class="headerlink" href="#realloc" title="Permalink to this headline">¶</a></h2>
<p>Funkcija <code class="docutils literal notranslate"><span class="pre">realloc</span></code> koristi se za promenu veličine prethodno alociranog bloka memorije. Memorija se prethodno mora zauzeti
korišćenjem funkcija <code class="docutils literal notranslate"><span class="pre">malloc</span></code> ili <code class="docutils literal notranslate"><span class="pre">calloc</span></code>. Realokacijom memorije se zadržavaju prethodne vrednosti i ne inicijalizuje se memorija na početnu vrednost.
Ukoliko je potrebno proširiti alocirani blok memorije (povećate njegovu veličinu), <code class="docutils literal notranslate"><span class="pre">realloc</span></code> će to i pokušati. Ako nije moguće
proširiti memoriju na postojećoj lokaciji (zbog fragmentacije ili drugih razloga), <code class="docutils literal notranslate"><span class="pre">realloc</span></code> može alocirati novi blok u nekoj
drugoj lokaciji i prekopirati sadržaj iz stare memorije u novu. Ukoliko je potrebno smanjiti veličinu memorijskog bloka, <code class="docutils literal notranslate"><span class="pre">realloc</span></code>
jednostavno seče blok i oslobađa višak memorije, čuvajući samo prvih new_size bajtova.
Ako je alokacija uspešna, <code class="docutils literal notranslate"><span class="pre">realloc</span></code> vraća generički pokazivač na prošireni ili skraćeni memorijski blok tipa <code class="docutils literal notranslate"><span class="pre">void</span> <span class="pre">*</span></code>.
Ovaj pokazivač može biti isti kao prethodni ili može biti nova adresa u slučaju premeštanja bloka. Ukoliko dođe do greške i nije
moguće alocirati memoriju, <code class="docutils literal notranslate"><span class="pre">realloc</span></code> vraća NULL, a originalni blok memorije ostaje nepromenjen.
Osnovna forma funkcije je:</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="nf">realloc</span><span class="p">(</span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="n">ptr</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">new_size</span><span class="p">);</span>
</pre></div>
</div>
<p>gde <code class="docutils literal notranslate"><span class="pre">size_t</span> <span class="pre">new_size</span></code> predstavlja novu veličinu memorije koju je potrebno zauzeti, a <code class="docutils literal notranslate"><span class="pre">void</span> <span class="pre">*ptr</span></code> pokazivač na prethodno zauzetu
memoriju koju je potrebno smanjiti ili povećati.</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;stdio.h&gt;</span>
<span class="linenos"> 2</span><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;stdlib.h&gt;</span>
<span class="linenos"> 3</span>
<span class="linenos"> 4</span><span class="kt">int</span><span class="w"> </span><span class="nf">main</span><span class="p">()</span>
<span class="linenos"> 5</span><span class="p">{</span>
<span class="linenos"> 6</span><span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="p">;</span>
<span class="linenos"> 7</span>
<span class="linenos"> 8</span><span class="w">    </span><span class="k">do</span>
<span class="linenos"> 9</span><span class="w">    </span><span class="p">{</span>
<span class="linenos">10</span><span class="w">        </span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;Unesite duzinu niza: &quot;</span><span class="p">);</span>
<span class="linenos">11</span><span class="w">        </span><span class="n">scanf</span><span class="p">(</span><span class="s">&quot;%d&quot;</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">n</span><span class="p">);</span>
<span class="linenos">12</span>
<span class="linenos">13</span><span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="k">while</span><span class="p">(</span><span class="n">n</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="mi">0</span><span class="p">);</span>
<span class="linenos">14</span>
<span class="linenos">15</span><span class="w">    </span><span class="n">a</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="n">malloc</span><span class="p">(</span><span class="n">n</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">sizeof</span><span class="p">(</span><span class="kt">int</span><span class="p">));</span>
<span class="linenos">16</span>
<span class="linenos">17</span><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">a</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="nb">NULL</span><span class="p">)</span>
<span class="linenos">18</span><span class="w">    </span><span class="p">{</span>
<span class="linenos">19</span><span class="w">        </span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;Memorija se ne moze zauzeti.</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
<span class="linenos">20</span><span class="w">        </span><span class="n">exit</span><span class="p">(</span><span class="n">EXIT_FAILURE</span><span class="p">);</span>
<span class="linenos">21</span><span class="w">    </span><span class="p">}</span>
<span class="linenos">22</span>
<span class="linenos">23</span><span class="w">    </span><span class="k">for</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">n</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span>
<span class="linenos">24</span><span class="w">    </span><span class="p">{</span>
<span class="linenos">25</span><span class="w">        </span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;a[%d] = &quot;</span><span class="p">,</span><span class="w"> </span><span class="n">i</span><span class="p">);</span>
<span class="linenos">26</span><span class="w">        </span><span class="n">scanf</span><span class="p">(</span><span class="s">&quot;%d&quot;</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">]);</span>
<span class="linenos">27</span><span class="w">    </span><span class="p">}</span>
<span class="linenos">28</span>
<span class="linenos">29</span><span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">m</span><span class="p">;</span>
<span class="linenos">30</span>
<span class="linenos">31</span><span class="w">    </span><span class="k">do</span>
<span class="linenos">32</span><span class="w">    </span><span class="p">{</span>
<span class="linenos">33</span><span class="w">        </span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;Unesite novu duzinu niza: &quot;</span><span class="p">);</span>
<span class="linenos">34</span><span class="w">        </span><span class="n">scanf</span><span class="p">(</span><span class="s">&quot;%d&quot;</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">m</span><span class="p">);</span>
<span class="linenos">35</span>
<span class="linenos">36</span><span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="k">while</span><span class="p">(</span><span class="n">m</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="mi">0</span><span class="p">);</span>
<span class="linenos">37</span>
<span class="linenos">38</span><span class="w">    </span><span class="c1">// Pokušaj da se poveća veličina niza koristeći realloc</span>
<span class="linenos">39</span><span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">tmp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="n">realloc</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="n">m</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">sizeof</span><span class="p">(</span><span class="kt">int</span><span class="p">));</span>
<span class="linenos">40</span>
<span class="linenos">41</span><span class="w">    </span><span class="c1">// Provera da li realloc nije uspeo</span>
<span class="linenos">42</span><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">tmp</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="nb">NULL</span><span class="p">)</span>
<span class="linenos">43</span><span class="w">    </span><span class="p">{</span>
<span class="linenos">44</span><span class="w">        </span><span class="c1">// Greška pri alokaciji, originalni blok je i dalje validan</span>
<span class="linenos">45</span><span class="w">        </span><span class="n">free</span><span class="p">(</span><span class="n">a</span><span class="p">);</span><span class="w"> </span><span class="c1">// Oslobađanje prethodno alocirane memorije</span>
<span class="linenos">46</span><span class="w">        </span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;Memorija se ne moze zauzeti.</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
<span class="linenos">47</span><span class="w">        </span><span class="n">exit</span><span class="p">(</span><span class="n">EXIT_FAILURE</span><span class="p">);</span>
<span class="linenos">48</span><span class="w">    </span><span class="p">}</span>
<span class="linenos">49</span>
<span class="linenos">50</span><span class="w">    </span><span class="c1">// Ako realloc uspe, dodeljujemo novi pokazivač</span>
<span class="linenos">51</span><span class="w">    </span><span class="n">a</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tmp</span><span class="p">;</span>
<span class="linenos">52</span>
<span class="linenos">53</span><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">m</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">n</span><span class="p">)</span>
<span class="linenos">54</span><span class="w">    </span><span class="p">{</span>
<span class="linenos">55</span><span class="w">        </span><span class="k">for</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">n</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">m</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span>
<span class="linenos">56</span><span class="w">        </span><span class="p">{</span>
<span class="linenos">57</span><span class="w">            </span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;a[%d] = &quot;</span><span class="p">,</span><span class="w"> </span><span class="n">i</span><span class="p">);</span>
<span class="linenos">58</span><span class="w">            </span><span class="n">scanf</span><span class="p">(</span><span class="s">&quot;%d&quot;</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">]);</span>
<span class="linenos">59</span><span class="w">        </span><span class="p">}</span>
<span class="linenos">60</span><span class="w">    </span><span class="p">}</span>
<span class="linenos">61</span>
<span class="linenos">62</span><span class="w">    </span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;Uneti niz je:</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
<span class="linenos">63</span><span class="w">    </span><span class="k">for</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">m</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span>
<span class="linenos">64</span><span class="w">    </span><span class="p">{</span>
<span class="linenos">65</span><span class="w">        </span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;a[%d] = %d</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">]);</span>
<span class="linenos">66</span><span class="w">    </span><span class="p">}</span>
<span class="linenos">67</span>
<span class="linenos">68</span><span class="w">    </span><span class="n">free</span><span class="p">(</span><span class="n">a</span><span class="p">);</span>
<span class="linenos">69</span><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="linenos">70</span><span class="p">}</span>
</pre></div>
</div>
<p>U primeru iznad unosimo prvo dužinu niza, nakon čega zauzimamo memoriju za tačno toliko članova niza korišćenjem funkcije <code class="docutils literal notranslate"><span class="pre">malloc</span></code>.
Kada smo pokušali da zauzememo memoriju, potrebno je da proverimo da li je ona uspešno zauzeta. Ukoliko je <code class="docutils literal notranslate"><span class="pre">malloc</span></code> vratio <code class="docutils literal notranslate"><span class="pre">NULL</span></code>,
izlazimo iz programa, ukoliko nije, unosimo članove niza. Nakon toga, unosimo novu dužinu niza i zauzimamo memoriju za promenjenu
dužinu korišćenjem funkcije <code class="docutils literal notranslate"><span class="pre">realloc</span></code>. Funkciji <code class="docutils literal notranslate"><span class="pre">realloc</span></code> prosleđujemo pokazivač na niz i <code class="docutils literal notranslate"><span class="pre">m</span> <span class="pre">*</span> <span class="pre">sizeof(int)</span></code> gde je <code class="docutils literal notranslate"><span class="pre">m</span></code> nova
dužina niza. Potrebno je da ponovo proverimo da li je memorija uspešno zauzeta ili je funkcija <code class="docutils literal notranslate"><span class="pre">realloc</span></code> vratila <code class="docutils literal notranslate"><span class="pre">NULL</span></code>. Ukoliko je
memorija zauzeta, proveravamo da li je nova dužina niza veća od stare i u tom slučaju unosimo ostale elemente niza. Za dužinu niza
sada uzimamo <code class="docutils literal notranslate"><span class="pre">m</span></code>, pa će <code class="docutils literal notranslate"><span class="pre">for</span></code> petlja za ispis svih elemenata niza ići do ove vrednosti. Na kraju programa, oslobađamo dinamički
zauzetu memoriju sa funkcijom <code class="docutils literal notranslate"><span class="pre">free</span></code>.</p>
<p>Ispis ovog programa je:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>Unesite duzinu niza: 3
a[0] = 1
a[1] = 2
a[2] = 3
Unesite novu duzinu niza: 5
a[3] = 4
a[4] = 5
Uneti niz je:
a[0] = 1
a[1] = 2
a[2] = 3
a[3] = 4
a[4] = 5
</pre></div>
</div>
</section>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../../../index.html">Zbirka zadataka</a></h1>








<h3>Navigacija</h3>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../../index.html">Praktikum</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../zadaci/t12.html">Zadaci za T12</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../zadaci/t34.html">Zadaci za T34</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../zadaci/sov.html">Zadaci za SOV</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../../../index.html">Documentation overview</a><ul>
  <li><a href="../../index.html">Praktikum</a><ul>
      <li>Previous: <a href="../11_bitwise/index.html" title="претходна глава"><span class="section-number">11. </span>Bitwise</a></li>
      <li>Next: <a href="../../../zadaci/t12.html" title="наредна глава">Zadaci za T12</a></li>
  </ul></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Brza pretraga</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Traži" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2024, Srđan Popov, Rade Radišić.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 4.4.0</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="../../../_sources/praktikum/poglavlja/12_dinamicka_alokacija/index.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>